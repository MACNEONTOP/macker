{"name": "Process Discovery via ps", "description": "Detects execution of the 'ps' command to enumerate running processes on macOS. Aggregates logs by TraceID to prevent noise.", "risk_score": 47, "severity": "medium", "type": "threshold", "query": "aul.processImagePath:\"/bin/ps\" AND aul.eventMessage:\"Retrieve User by ID\"", "language": "kuery", "index": ["mac-*"], "filters": [], "author": ["HJ"], "false_positives": ["Legitimate administrative usage for debugging or system monitoring", "Developer commands executed in terminal sessions"], "references": ["https://attack.mitre.org/techniques/T1057/"], "tags": ["attack.discovery", "attack.t1057", "threat_score_1:50.5", "threat_score_1_risk_level:MEDIUM", "threat_score_2:4.0", "final_risk_score:47"], "rule_id": "2177b63d-1156-463c-9f60-47d182adf393", "enabled": true, "interval": "5m", "from": "now-6m", "to": "now", "actions": [], "throttle": "no_actions", "threshold": {"field": "aul.traceID", "value": 1}, "meta": {"from": "1m", "kibana_siem_app_url": "/app/security"}, "threat": [{"framework": "MITRE ATT&CK", "tactic": {"id": "TA0007", "name": "Discovery", "reference": "https://attack.mitre.org/tactics/TA0007/"}, "technique": [{"id": "T1057", "name": "Process Discovery", "reference": "https://attack.mitre.org/techniques/T1057/"}]}], "mitre_tactic": ["Discovery"], "mitre_tactic_id": ["TA0007"], "mitre_technique": ["Process Discovery"], "mitre_id": ["T1057"], "x_mitre_scores": {"paper_score_v1": 4.03, "paper_score_v2": 4.03, "korean_final_score": 4.03, "korean_risk_level": "MEDIUM", "threat_score": 50.5, "protection_score": 49.5, "final_risk_score": 47}, "max_signals": 100, "version": 1}